<?php

namespace Spatie\Holidays\Countries;

use Carbon\CarbonImmutable;

class Japan extends Country
{
    public function countryCode(): string
    {
        return 'ja';
    }

    protected function allHolidays(int $year): array
    {
        return array_merge([
            '元旦' => '01-01',
            '建国記念の日' => '02-11',
            '天皇誕生日' => '02-23',
            '昭和の日' => '04-29',
            '憲法記念日' => '05-03',
            'みどりの日' => '05-04',
            'こどもの日' => '05-05',
            '山の日' => '08-11',
            '文化の日' => '11-03',
            '勤労感謝の日' => '11-23',
        ], $this->variableHolidays($year));
    }

    /** @return array<string, CarbonImmutable> */
    protected function variableHolidays(int $year): array
    {
        return [
            '成人の日' => CarbonImmutable::parse("second monday of January $year", 'Asia/Tokyo'),
            '春分の日' => CarbonImmutable::parse("$year-" . $this->getVernalEquinoxDay($year)),
            '海の日' => CarbonImmutable::parse("third monday of July $year", 'Asia/Tokyo'),
            '敬老の日' => CarbonImmutable::parse("third monday of September $year", 'Asia/Tokyo'),
            '秋分の日' => CarbonImmutable::parse("$year-" . $this->getAutumnalEquinoxDay($year)),
            'スポーツの日' => CarbonImmutable::parse("second monday of October $year", 'Asia/Tokyo'),
        ];
    }

    protected function getVernalEquinoxDay(int $year): string
    {
        return [
            1970 => '03-21',
            1971 => '03-21',
            1972 => '03-20',
            1973 => '03-21',
            1974 => '03-21',
            1975 => '03-21',
            1976 => '03-20',
            1977 => '03-21',
            1978 => '03-21',
            1979 => '03-21',
            1980 => '03-20',
            1981 => '03-21',
            1982 => '03-21',
            1983 => '03-21',
            1984 => '03-20',
            1985 => '03-21',
            1986 => '03-21',
            1987 => '03-21',
            1988 => '03-20',
            1989 => '03-21',
            1990 => '03-21',
            1991 => '03-21',
            1992 => '03-20',
            1993 => '03-20',
            1994 => '03-20',
            1995 => '03-21',
            1996 => '03-20',
            1997 => '03-20',
            1998 => '03-21',
            1999 => '03-21',
            2000 => '03-20',
            2001 => '03-20',
            2002 => '03-21',
            2003 => '03-21',
            2004 => '03-20',
            2005 => '03-20',
            2006 => '03-21',
            2007 => '03-21',
            2008 => '03-20',
            2009 => '03-20',
            2010 => '03-21',
            2011 => '03-21',
            2012 => '03-20',
            2013 => '03-20',
            2014 => '03-21',
            2015 => '03-21',
            2016 => '03-20',
            2017 => '03-20',
            2018 => '03-21',
            2019 => '03-21',
            2020 => '03-20',
            2021 => '03-20',
            2022 => '03-21',
            2023 => '03-21',
            2024 => '03-20',
        ][$year] ?? '03-20';
    }

    protected function getAutumnalEquinoxDay(int $year): string
    {
        return [
            1970 => '09-23',
            1971 => '09-24',
            1972 => '09-23',
            1973 => '09-23',
            1974 => '09-23',
            1975 => '09-24',
            1976 => '09-23',
            1977 => '09-23',
            1978 => '09-23',
            1979 => '09-24',
            1980 => '09-23',
            1981 => '09-23',
            1982 => '09-23',
            1983 => '09-23',
            1984 => '09-23',
            1985 => '09-23',
            1986 => '09-23',
            1987 => '09-23',
            1988 => '09-23',
            1989 => '09-23',
            1990 => '09-23',
            1991 => '09-23',
            1992 => '09-23',
            1993 => '09-23',
            1994 => '09-23',
            1995 => '09-23',
            1996 => '09-23',
            1997 => '09-23',
            1998 => '09-23',
            1999 => '09-23',
            2000 => '09-23',
            2001 => '09-24',
            2002 => '09-23',
            2003 => '09-23',
            2004 => '09-23',
            2005 => '09-23',
            2006 => '09-23',
            2007 => '09-23',
            2008 => '09-23',
            2009 => '09-23',
            2010 => '09-23',
            2011 => '09-23',
            2012 => '09-22',
            2013 => '09-23',
            2014 => '09-23',
            2015 => '09-23',
            2016 => '09-22',
            2017 => '09-23',
            2018 => '09-23',
            2019 => '09-23',
            2020 => '09-22',
            2021 => '09-23',
            2022 => '09-23',
            2023 => '09-23',
            2024 => '09-22',
        ][$year] ?? '09-22';
    }

}
